<div class="tender-page-card">
  <div class="page-header">
    <h1 class="pageName">مدیریت مناقصه‌ها</h1>
    <div class="actionBar">
      <label class="include-expired-toggle">
        <span>نمایش مناقصه‌های منقضی‌شده</span>
        <nz-switch [ngModel]="includeExpired" (ngModelChange)="toggleIncludeExpired($event)"></nz-switch>
      </label>
      <button nz-button nzType="primary" nzShape="round" nzSize="large" (click)="addRow()">افزودن مناقصه جدید</button>
    </div>
  </div>

  <nz-collapse class="filter-collapse" nzGhost [nzBordered]="false">
    <nz-collapse-panel
      class="filter-collapse-panel"
      [(nzActive)]="filtersExpanded"
      [nzShowArrow]="false"
      [nzHeader]="filtersHeader"
    >
      <div class="floating-filter-layout">
        <div class="floating-filter-toolbar">
          <div class="button-group">
            <button class="toolbar-button" type="button" (click)="filterActiveTenders()">مناقصه‌های فعال</button>
            <button class="toolbar-button" type="button" (click)="filterEndingSoon()">
              رو به اتمام
              <span class="button-note">(۷ روز آینده)</span>
            </button>
            <button class="toolbar-button" type="button" (click)="filterRecentlyStarted()">شروع شده در هفته اخیر</button>
            <button class="toolbar-button link" type="button" (click)="clearDateFilters()">حذف فیلتر تاریخ</button>
          </div>
          <div class="button-group">
            <button class="toolbar-button" type="button" (click)="filterHighBudget()">
              بودجه بالا
              <span class="button-note">(+۵ میلیارد)</span>
            </button>
            <button class="toolbar-button" type="button" (click)="filterMidBudget()">
              بودجه متوسط
              <span class="button-note">(۱ تا ۵ میلیارد)</span>
            </button>
            <button class="toolbar-button" type="button" (click)="filterLowBudget()">بودجه زیر ۱ میلیارد</button>
            <button class="toolbar-button link" type="button" (click)="clearBudgetFilters()">حذف فیلتر مبلغ</button>
          </div>
          <div class="button-group">
            <button class="toolbar-button" type="button" (click)="filterHasParticipants()">با شرکت‌کننده</button>
            <button class="toolbar-button" type="button" (click)="filterNoParticipants()">بدون شرکت‌کننده</button>
            <button class="toolbar-button link" type="button" (click)="clearParticipationFilter()">حذف فیلتر مشارکت</button>
          </div>
          <div class="button-group">
            <button class="toolbar-button primary" type="button" (click)="clearAllFilters()">بازنشانی همه فیلترها</button>
          </div>
        </div>
      </div>
    </nz-collapse-panel>
  </nz-collapse>
  <ng-template #filtersHeader>
    <div class="filters-header">
      <div class="filters-header-title">
        <span nz-icon nzType="filter"></span>
        <span>فیلترهای پیشرفته</span>
      </div>
      <button nz-button nzType="link" class="filters-toggle" (click)="onToggleFilters($event)">
        {{ filtersExpanded ? 'بستن فیلترها' : 'باز کردن فیلترها' }}
        <span nz-icon [nzType]="filtersExpanded ? 'up' : 'down'"></span>
      </button>
    </div>
  </ng-template>

  <div class="grid-card">
    <div class="grid-wrapper">
      <ag-grid-angular
        class="ag-theme-quartz tender-grid"
        [theme]="'legacy'"
        [enableRtl]="true"
        [columnDefs]="columnDefs"
        [defaultColDef]="defaultColumnDefs"
        [rowData]="rowData"
        (gridReady)="onGridReady($event)"
        (cellClicked)="onCellClicked($event)"
      ></ag-grid-angular>
    </div>
  </div>
</div>

<form nz-form [formGroup]="validateForm">
  <nz-modal [(nzVisible)]="isEditModalVisible" nzTitle="ویرایش مناقصه" nzOkText="ذخیره" nzCancelText="انصراف"
    [nzOkLoading]="loading" (nzOnOk)="submitForm()" (nzOnCancel)="isEditModalVisible = false" nzDirection="rtl">
    <ng-container *nzModalContent>
      <nz-form-item>
        <nz-form-label [nzSm]="8" [nzXs]="24" nzRequired>عنوان</nz-form-label>
        <nz-form-control [nzSm]="16" [nzXs]="24">
          <input type="text" nz-input formControlName="Title" placeholder="عنوان مناقصه" />
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSm]="8" [nzXs]="24" nzRequired>توضیحات</nz-form-label>
        <nz-form-control [nzSm]="16" [nzXs]="24">
          <textarea formControlName="Description" nz-input rows="3" placeholder="توضیحات مناقصه"></textarea>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSm]="8" [nzXs]="24" nzRequired>تاریخ شروع</nz-form-label>
        <nz-form-control [nzSm]="16" [nzXs]="24">
          <nz-date-picker formControlName="BeginDate" nzPlaceHolder="انتخاب تاریخ"></nz-date-picker>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSm]="8" [nzXs]="24" nzRequired>تاریخ پایان</nz-form-label>
        <nz-form-control [nzSm]="16" [nzXs]="24">
          <nz-date-picker formControlName="EndDate" nzPlaceHolder="انتخاب تاریخ"></nz-date-picker>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSm]="8" [nzXs]="24" nzRequired>حداقل قیمت</nz-form-label>
        <nz-form-control [nzSm]="16" [nzXs]="24">
          <nz-input-number formControlName="FromPrice" [nzMin]="0" [nzMax]="999999999" [nzStep]="1000"
            style="width: 200px"></nz-input-number>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSm]="8" [nzXs]="24" nzRequired>حداکثر قیمت</nz-form-label>
        <nz-form-control [nzSm]="16" [nzXs]="24">
          <nz-input-number formControlName="ToPrice" [nzMin]="0" [nzMax]="999999999" [nzStep]="1000"
            style="width: 200px"></nz-input-number>
        </nz-form-control>
      </nz-form-item>
    </ng-container>
  </nz-modal>
</form>
