<div class="tender-page-card">
  <div class="page-header">
    <h1 class="pageName">پیشنهادات من</h1>
  </div>

  <div class="grid-card">
    <div class="grid-wrapper">
      <ag-grid-angular
        class="ag-theme-quartz tender-grid"
        [theme]="'legacy'"
        [enableRtl]="true"
        [columnDefs]="columnDefs"
        [defaultColDef]="defaultColumnDefs"
        [rowData]="rowData"
        [pagination]="false"
        (gridReady)="onGridReady($event)"
      ></ag-grid-angular>
    </div>
    <nz-pagination
      class="grid-pagination"
      [nzPageIndex]="pageIndex"
      [nzTotal]="total"
      [nzPageSize]="pageSize"
      [nzPageSizeOptions]="[10, 20, 50]"
      [nzShowSizeChanger]="true"
      [nzDisabled]="loading"
      (nzPageIndexChange)="onPageIndexChange($event)"
      (nzPageSizeChange)="onPageSizeChange($event)"
    ></nz-pagination>
  </div>
</div>

<form nz-form [formGroup]="validateForm">
  <nz-modal
    [(nzVisible)]="isEditModalVisible"
    nzTitle="ویرایش پیشنهاد"
    nzOkText="ذخیره"
    nzCancelText="انصراف"
    (nzOnOk)="submitForm()"
    (nzOnCancel)="isEditModalVisible = false"
    nzDirection="rtl"
  >
    <ng-container *nzModalContent>
      <ng-container *ngIf="selectedOffer as offer">
        <p class="modal-description">
          {{ offer.TenderOffer?.Title }} — بازه مجاز:
          {{ offer.TenderOffer?.FromPrice | number }} تا {{ offer.TenderOffer?.ToPrice | number }}
        </p>
        <nz-form-item>
          <nz-form-label [nzSm]="8" [nzXs]="24" nzRequired>مبلغ پیشنهادی</nz-form-label>
          <nz-form-control [nzSm]="16" [nzXs]="24">
            <nz-input-number
              formControlName="PriceOffer"
              [nzMin]="offer.TenderOffer?.FromPrice ?? 0"
              [nzMax]="offer.TenderOffer?.ToPrice ?? 999999999"
              [nzStep]="1000"
              style="width: 200px"
            ></nz-input-number>
            <div class="form-error" *ngIf="validateForm.get('PriceOffer')?.invalid && validateForm.get('PriceOffer')?.dirty">
              مبلغ باید در بازه تعیین شده باشد.
            </div>
          </nz-form-control>
        </nz-form-item>
      </ng-container>
    </ng-container>
  </nz-modal>
</form>
